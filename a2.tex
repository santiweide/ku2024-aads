\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{upquote}
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb}
\usepackage{graphicx}
\usepackage{listings}
\newenvironment{statement}[2][Statement]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\usepackage{xcolor}




\title{Assignment 1}


\author{Author \\
  Wanjing Hu / fng685@alumni.ku.dk  \\
  Zhigao Yan / sxd343@alumni.ku.dk  \\
  Wenshuo Dong / gnj461@alumni.ku.dk  \\
  Jiayi Zhang / xrw579@alumni.ku.dk \\
} 
 

\begin{document}
\maketitle

\section{29.1-9}
% wenshuo 

\section{29.2-3}
% jiayi

\section{29.2-6}
% wanjing
\textbf{Question:}
Write a linear program that, given a bipartite graph $G = (V,E)$, solves the maximum-bipartite matching problem.

\textbf{Answer}

Let $V = L \cup R$, $L \cap R = \emptyset$ . Then make a new vertex for the source which has an edge of unit capacity going to each of the vertices in $L$, and a new vertex for sink which has an edge from each of the vertices in $R$, and we have a new graph $G'=(V',E')$, where $V' = V \cup \{s,t\}$, $E' = E \cup \{s, t\}$. The capacity of edges going out of $s$ and going into $t$ are all 1. Also every original edge from left to right are edges with capacity 1.

First we need to prove the finding maximum-bipartite matching $M$ in the original bipartite graph $G$ is equivalent to finding the max flow in the graph $G$. The proof is as follows:

We first show that a matching $M$ in $G$ corresponds to an integer valued flow $f$ in $G'$. Define $f$ as follows: If $(u,v) \in M$, then $f(s,u) = f(u,v) = f(v,t) = 1$. For all other edges $(u,v) \in E'$, we define $f(u,v) = 0$. Then we have $f$ satisfying both the capacity constraint and the flow conservation.

Next, we can see each edge $(u,v) \in M$ corresponse to one unit flow in $G'$ that traverses the path $s \rightarrow u \rightarrow v \rightarrow t$. Moreover, the paths induced by edges in $M$ are vertext-disjoint, except for $s$ and $t$. The net flow across cut $(L \cup \{s\}, R \cup \{t\})$ is equal to $|M|$. thus the value of the flow $|f| = M$. 

Then we also need to prove $|M| = |f|$ in the converse side. Let $f$ be an integer-valued flow in $G'$ and let $M = \{(u,v): u \in L,\, v \in R,\, and\, f(u,v) >0\}$.

By flow conservation, each $u \in L$ has at most one unit of flow entering the edge $(s,u)$, and since $f$ is integer valued, for each $u \in L$, the one unit of flow can enter on at most one edge and can leave on at most one edge. Then one unit of flpw enters $u$ if and only if there is exactly one vertex $v \in R$ such that $f(u,v) = 1$, and at most one edge leaving each $u \in L$ carries positive flow. A symmetric proof can be made for each $v \in R$ Thus the set M is a matching.

Then the linear programming problem could be defined as follows:

\begin{equation}
\begin{aligned}
maximize& \\
& \sum_{v \in L} f_{(s,v)}\\
subject \, to&  \\
& f_{(u,v)} <=1 \, for \, each \, u,v \in \{s\} \cup L \cup R \cup \{t\} = V\\ 
& \sum_{v \in V} f_{(v,u)} = \sum_{v \in V} f_{(u,v)} \, for \, each \, u \in L \cup R\\
&f_{(u,v)} >= 0 \, for \,each \, u,v \in V
\end{aligned}
\end{equation}


\section{29.4-3}
% zhigao
\textbf{Question:}
Write down the dual of the maximum-flow linear program, as given in lines
(29.47)â€“(29.50) on page 860. Explain how to interpret this formulation as a
minimum-cut problem.\\
\textbf{Answer:}
Firstly, I need to convert the original formulas to standard form.
We can set a coefficient C that is 1 when \(u=s\) and -1 when \(v=s\).
\[
\begin{aligned}
maximize& \\
&\sum_{u,v \in V} Cfuv, \\
subject \, to& \\
&f_{uv} \leq c(u, v), \quad \text{for each } u, v \in V, \\
&\sum_{v \in V} f_{vu} = \sum_{v \in V} f_{uv}, \quad \text{for each } u \in V \setminus \{s, t\}, \\
&f_{uv} \geq 0, \quad \text{for each } u, v \in V.
\end{aligned}
\]
The second formula can be changed to 
\[
\sum_{v \in V} f_{vu} - \sum_{v \in V} f_{uv} \leq 0 \quad \text{for each } u \in V \setminus \{s, t\}
\]
\[-\sum_{v \in V} f_{vu} + \sum_{v \in V} f_{uv} \leq 0\ \quad \text{for each } u \in V \setminus \{s, t\}\]
Now we can get the dual subject function by the subject function, for capacity constraints and flow conservation, \(y_{uv}\), \(y_u\)(flow conservation for \(u\)) and \(y_v\)(flow conservation for \(v\))can be introduced, 

\[y_{uv}-y_u+y_v \geq C \quad \text{for each } u, v \in V\]
We can split this equation into:
\[y_{uv}-y_u+y_v \geq 0 \quad \text{for each } u, v \in V\setminus \{s, t\}\]
\[y_{sv}+y_v \geq 1 \quad \text{for each } v \in V\setminus \{s\}\]
\[y_{us}-y_u \geq -1 \quad \text{for each } u \in V\setminus \{s\}\]
\[y_{uv} \geq 0, \quad y_u \geq 0,\quad y_v\geq 0\]
The final object function is :
\[minimize \quad \sum_{u,v \in V} c(u,v)y_{uv}\]
From the object function, we can set \(y_{uv}\) as the variable for every edge, if one edge has been "cut", we need to add the capacity to the result. We can also think of \(y_u\) as the attribution of each point(without s and t). These constraints are to ensure that if two points belong to different sets, then edge \(uv\) must be cut.




\section{Linear Programming - B}
\textbf{Question:}
Write an LP in standard form in the plane so that: (1) the feasible region is a convex polygon with 5 edges, (2) the maximum of the LP is 1 and (3) the maximum is achieved on a full edge of the feasible region (and not just a single vertex)
% wenshuo

\section{Linear Programming - C}
\textbf{Question}
This exercise demonstrates that LP can represent non-linearities (like absolute values). Let f be a function from the set {1,2} to the real numbers. 

Write an LP whose value is $|f(1)|+|f(2)|$, and write the dual to this LP. In your solutions, all the entries in the matrix A and in the vectors b,c must be affine functions in $f(1)$ and $f(2)$; that is, each entry must be of the form $d f(1) + e f(2) + g$ where $d$,$e$,$g$ are real numbers. For example, in dimension n = 3, the vector b can be $(3 f(1), 0, -2f(2)+1)$ but not $(|f(1)|,0,0)$. 
% jiayi


\section{Randomized Algorithm-1}
\textbf{Question}
For any given key $x$ in $S$, let $d(x)$ be the depth of $x$ in the search tree generated by $RandQS$. Give a lower and an upper bound, as a function of the number of keys n, on the expected value of $d(x)$ such that these bounds are within a constant factor from each other. That is, find a function $f(n)$ and prove that $E[d(x)]=\Theta(f(n))$.

% wanjing
\textbf{Answer}
Let $S$ be the set of the $n$ keys, then for $x,y \in S$ the comparison between $x$ and $y$ will occur when $x$ and $y$ are in the same subproblem during the step of a recursion, and one of them is chosen as a pivot. For any pair $(x,y)$, we note the probability that $x$, $y$ are in the same subproblem as $A$. Then we have:

\begin{equation}
P(A) = 2/n
\end{equation}
Also, from the definition of $d(x)$ we can see $d(x)$ equals to the number of comparisons involving $x$ during the partition process. Then we have 

\begin{equation}
\begin{aligned}
E(d(x)) &= \sum_{k=1}^{n-1} 2/k\\
&= 2*(1 + 1/2 + 1/3 + ... + 1/n-1)
\end{aligned}
\end{equation}

Since we have:
\begin{equation}
\begin{aligned}
\int_{1}^{n-1} \frac{1}{x} dx = log(n-1)
\end{aligned}
\end{equation}

So we have
\begin{equation}
\begin{aligned}
E[d(x)] &<= 2*(1 + log(n-1))\\
E[d(x)] &>= 2(*log(n-1))
\end{aligned}
\end{equation}

That is:
\begin{equation}
\begin{aligned}
E[d(x)] &<= 2*log(n) + C\\
E[d(x)] &>= 2*log(n) - C
\end{aligned}
\end{equation}

So we have
\begin{equation}
\begin{aligned}
E[d(x)] = \Theta(log(n))\\
\end{aligned}
\end{equation}


\section{Randomized Algorithm-2}
\textbf{Question}
How many runs of randomized contraction do we need to be 99\% sure that a minimum cut is found?
% zhigao
\textbf{Answer}:
Every time we run the randomized contraction, the probability of min-cut is returned is (n is the number of vectors in the graph):
\[P\geq\frac{2}{n(n-1)}\]
So the probability of min-cut is not returned is :
\[P\geq1-\frac{2}{n(n-1)}\]
By t times, this probability is :
\[(1-\frac{2}{n(n-1)})^t\]
We want to ensure 99\% that a minimum cut is found, Hence:
\[(1-\frac{2}{n(n-1)})^t\leq0.01\]
\[=tln(1-\frac{2}{n(n-1)})\leq ln(0.01)\]
\[=t\leq \frac{ln(0.01)}{ln(1-\frac{2}{n(n-1)})}\]
By using the \(1+x\leq e^x \rightarrow ln(1+x)\leq x\), we get:
\[=t\leq \frac{ln(0.01)}{-\frac{2}{n(n-1)}}\]
Finally, If we want to guarantee more than 99\% probability, then the number of times \(t\) needs to satisfy the following condition.
\[
t \geq \frac{4.605 \cdot n(n - 1)}{2}.
\]


\section{Randomized Algorithm-exercises 1.2}
% wenshuo

\section{Randomized Algorithm-exercises 1.3}
%you may assume that T(n) is the worst case running time of A.
% jiayi

\end{document}
